
/*arreglo de objetos*/
var productosArray = [
    //SABANAS pos 0 a 9
    {
        id: "sabana01",/*este el id del prod */
        titulo: "Sabana 2 plazas- Diseño Floral",
        imagen: "../img/productos/cama/sabanas/2plazas1.webp",
        precio: 35000,
        categoria: {
            nombre: "Sabanas",
            id: "sab"/*este el id de la categoria*/
        },

    },
    {
        id: "sabana02",/*este el id del prod */
        titulo: "Sabana 2 plazas- Diseño Lineas",
        imagen: "../img/productos/cama/sabanas/2plazas2.webp",
        precio: 35000,
        categoria: {
            nombre: "Sabanas",
            id: "sab"/*este el id de la categoria*/
        },

    },
    {
        id: "sabana03",/*este el id del prod */
        titulo: "Sabana 2 plazas- Color claro",
        imagen: "../img/productos/cama/sabanas/2plazas3.webp",
        precio: 38000,
        categoria: {
            nombre: "Sabanas",
            id: "sab"/*este el id de la categoria*/
        },

    },
    {
        id: "sabana04",/*este el id del prod */
        titulo: "Sabana 2 plazas- Blanco puro",
        imagen: "../img/productos/cama/sabanas/2plazas4.webp",
        precio: 38000,
        categoria: {
            nombre: "Sabanas",
            id: "sab"/*este el id de la categoria*/
        },

    },
    {
        id: "sabana05",/*este el id del prod */
        titulo: "Sabana 2 plazas- Diseño Lila",
        imagen: "../img/productos/cama/sabanas/2plazas5.webp",
        precio: 35000,
        categoria: {
            nombre: "Sabanas",
            id: "sab"/*este el id de la categoria*/
        },

    },
    {
        id: "sabana06",/*este el id del prod */
        titulo: "Sabana 2 plazas- Diseño Beige Lineas",
        imagen: "../img/productos/cama/sabanas/sabana6.webp",
        precio: 30000,
        categoria: {
            nombre: "Sabanas",
            id: "sab"/*este el id de la categoria*/
        },


    },
    {
        id: "sabana07",/*este el id del prod */
        titulo: "Sabana 2 plazas- Diseño impactante",
        imagen: "../img/productos/cama/sabanas/sabana7.webp",
        precio: 40000,
        categoria: {
            nombre: "Sabanas",
            id: "sab"/*este el id de la categoria*/
        },

    },
    {
        id: "sabana08",/*este el id del prod */
        titulo: "Sabana 2 plazas- Diseño Beige de lujo",
        imagen: "../img/productos/cama/sabanas/sabana8.webp",
        precio: 45000,
        categoria: {
            nombre: "Sabanas",
            id: "sab"/*este el id de la categoria*/
        },

    },
    {
        id: "sabana09",/*este el id del prod */
        titulo: "Sabana 2 plazas- Diseño Azul",
        imagen: "../img/productos/cama/sabanas/sabana9.webp",
        precio: 45000,
        categoria: {
            nombre: "Sabanas",
            id: "sab"/*este el id de la categoria*/
        },

    },
    {
        id: "sabana10",/*este el id del prod */
        titulo: "Sabana 2 plazas- Diseño Coral Delicado",
        imagen: "../img/productos/cama/sabanas/sabana10.webp",
        precio: 35000,
        categoria: {
            nombre: "Sabanas",
            id: "sab"/*este el id de la categoria*/
        },

    },

    //CUBRECAMA pos 10 a 19

    {
        id: "cubrecama01",/*este el id del prod */
        titulo: "Cubrecama 2 plazas- Diseño Lila",
        imagen: "../img/productos/cama/cubrecama/cubrecama1.webp",
        precio: 38000,
        categoria: {
            nombre: "Cubrecamas",
            id: "cubre"/*este el id de la categoria*/
        },

    },
    {
        id: "cubrecama02",/*este el id del prod */
        titulo: "Cubrecama 2 plazas- Diseño Turquesa  Quilt Reversible",
        imagen: "../img/productos/cama/cubrecama/cubrecama2.webp",
        precio: 38000,
        categoria: {
            nombre: "Cubrecamas",
            id: "cubre"/*este el id de la categoria*/
        },

    },
    {
        id: "cubrecama03",/*este el id del prod */
        titulo: "Cubrecama 2 plazas- Diseño Turquesa  Quilt Reversible",
        imagen: "../img/productos/cama/cubrecama/cubrecama3.webp",
        precio: 38000,
        categoria: {
            nombre: "Cubrecamas",
            id: "cubre"/*este el id de la categoria*/
        },

    },
    {
        id: "cubrecama04",/*este el id del prod */
        titulo: "Cubrecama 2 plazas- Diseño Gris Quilt Reversible",
        imagen: "../img/productos/cama/cubrecama/cubrecama4.webp",
        precio: 38000,
        categoria: {
            nombre: "Cubrecamas",
            id: "cubre"/*este el id de la categoria*/
        },

    },
    {
        id: "cubrecama05",/*este el id del prod */
        titulo: "Cubrecama 2 plazas- Diseño verde geometrico",
        imagen: "../img/productos/cama/cubrecama/cubrecama5.webp",
        precio: 42000,
        categoria: {
            nombre: "Cubrecamas",
            id: "cubre"/*este el id de la categoria*/
        },

    },
    {
        id: "cubrecama06",/*este el id del prod */
        titulo: "Cubrecama 2 plazas- Diseño Beige  Quilt",
        imagen: "../img/productos/cama/cubrecama/cubrecama6.webp",
        precio: 38000,
        categoria: {
            nombre: "Cubrecamas",
            id: "cubre"/*este el id de la categoria*/
        },

    },
    {
        id: "cubrecama07",/*este el id del prod */
        titulo: "Cubrecama 2 plazas- Diseño Verde agua Quilt",
        imagen: "../img/productos/cama/cubrecama/cubrecama7.webp",
        precio: 38000,
        categoria: {
            nombre: "Cubrecamas",
            id: "cubre"/*este el id de la categoria*/
        },

    },
    {
        id: "cubrecama08",/*este el id del prod */
        titulo: "Cubrecama 2 plazas- Diseño estampado ",
        imagen: "../img/productos/cama/cubrecama/cubrecama8.webp",
        precio: 42000,
        categoria: {
            nombre: "Cubrecamas",
            id: "cubre"/*este el id de la categoria*/
        },

    },
    {
        id: "cubrecama09",/*este el id del prod */
        titulo: "Cubrecama 2 plazas- Diseño Estampa Indú",
        imagen: "../img/productos/cama/cubrecama/cubrecama9.webp",
        precio: 45000,
        categoria: {
            nombre: "Cubrecamas",
            id: "cubre"/*este el id de la categoria*/
        },

    },
    {
        id: "cubrecama10",/*este el id del prod */
        titulo: "Cubrecama 2 plazas- Diseño Rombos reversible",
        imagen: "../img/productos/cama/cubrecama/cubrecama10.webp",
        precio: 42000,
        categoria: {
            nombre: "Cubrecamas",
            id: "cubre"/*este el id de la categoria*/
        },

    },

    //ACOLCHADOS POS 20 AL 26

    {
        id: "acolchado01",/*este el id del prod */
        titulo: "Acolchado 2 plazas- Estampado claro con piel",
        imagen: "../img/productos/cama/acolchado/acolchado1.webp",
        precio: 50000,
        categoria: {
            nombre: "Acolchados",
            id: "acolchado"/*este el id de la categoria*/
        },

    },
    {
        id: "acolchado02",/*este el id del prod */
        titulo: "Acolchado 2 plazas- Estampado beige con piel",
        imagen: "../img/productos/cama/acolchado/acolchado2.webp",
        precio: 58000,
        categoria: {
            nombre: "Acolchados",
            id: "acolchado"/*este el id de la categoria*/
        },

    },
    {
        id: "acolchado03",/*este el id del prod */
        titulo: "Acolchado 2 plazas- Rosa con lineas",
        imagen: "../img/productos/cama/acolchado/acolchado3.webp",
        precio: 48000,
        categoria: {
            nombre: "Acolchados",
            id: "acolchado"/*este el id de la categoria*/
        },

    },
    {
        id: "acolchado04",/*este el id del prod */
        titulo: "Acolchado 1 plazas- Estampado Dinosaurios",
        imagen: "../img/productos/cama/acolchado/acolchado4.webp",
        precio: 40000,
        categoria: {
            nombre: "Acolchados",
            id: "acolchado"/*este el id de la categoria*/
        },

    },
    
    {
        id: "acolchado05",/*este el id del prod */
        titulo: "Acolchado 1 plazas- Minnie",
        imagen: "../img/productos/cama/acolchado/acolchado5.webp",
        precio: 42000,
        categoria: {
            nombre: "Acolchados",
            id: "acolchado"/*este el id de la categoria*/
        },

    },
    {
        id: "acolchado06",/*este el id del prod */
        titulo: "Acolchado 1 plazas- Frozen",
        imagen: "../img/productos/cama/acolchado/acolchado6.webp",
        precio: 42000,
        categoria: {
            nombre: "Acolchados",
            id: "acolchado"/*este el id de la categoria*/
        },

    },
    {
        id: "acolchado07",/*este el id del prod */
        titulo: "Acolchado 1 plazas- Estampado MAR",
        imagen: "../img/productos/cama/acolchado/acolchado7.webp",
        precio: 40000,
        categoria: {
            nombre: "Acolchados",
            id: "acolchado"/*este el id de la categoria*/
        },

    },

    //toallas pos 27 a 34

    {
        id: "toallon01",/*este el id del prod */
        titulo: "Set de toalla y toallon turquesa",
        imagen: "../img/productos/toallas/set1.webp",
        precio: 37500,
        categoria: {
            nombre: "Toallones",
            id: "set"/*este el id de la categoria*/
        },

    },
    {
        id: "toallon02",/*este el id del prod */
        titulo: "Set de toalla y toallon bordo",
        imagen: "../img/productos/toallas/set2.webp",
        precio: 37500,
        categoria: {
            nombre: "Toallones",
            id: "set"/*este el id de la categoria*/
        },

    },
    {
        id: "toallon03",/*este el id del prod */
        titulo: "Set de toalla y toallon beige",
        imagen: "../img/productos/toallas/set3.webp",
        precio: 35000,
        categoria: {
            nombre: "Toallones",
            id: "set"/*este el id de la categoria*/
        },

    },
    {
        id: "toallon04",/*este el id del prod */
        titulo: "Set de toalla y toallon de lujo",
        imagen: "../img/productos/toallas/set4.webp",
        precio: 49000,
        categoria: {
            nombre: "Toallones",
            id: "set"/*este el id de la categoria*/
        },

    },
    {
        id: "toallon05",/*este el id del prod */
        titulo: "Set de toalla y toallon naranja",
        imagen: "../img/productos/toallas/set5.webp",
        precio: 37500,
        categoria: {
            nombre: "Toallones",
            id: "set"/*este el id de la categoria*/
        },

    },
    {
        id: "toallon06",/*este el id del prod */
        titulo: "Set de toalla y toallon colores",
        imagen: "../img/productos/toallas/set6.webp",
        precio: 32000,
        categoria: {
            nombre: "Toallones",
            id: "set"/*este el id de la categoria*/
        },

    },

    {
        id: "toallon07",/*este el id del prod */
        titulo: "Toallon Gris topo",
        imagen: "../img/productos/toallas/set7.webp",
        precio: 22500,
        categoria: {
            nombre: "Toallones",
            id: "set"/*este el id de la categoria*/
        },

    },
    {
        id: "toallon05",/*este el id del prod */
        titulo: "Toallon playero",
        imagen: "../img/productos/toallas/set8.webp",
        precio: 20000,
        categoria: {
            nombre: "Toallones",
            id: "set"/*este el id de la categoria*/
        },

    },

    //batas pos 34 a 38


    {
        id: "bata01",/*este el id del prod */
        titulo: "Bata hotel",
        imagen: "../img/productos/batas/bata1.webp",
        precio: 30000,
        categoria: {
            nombre: "Batas",
            id: "bata"/*este el id de la categoria*/
        },

    },
    {
        id: "bata02",/*este el id del prod */
        titulo: "Bata roja",
        imagen: "../img/productos/batas/bata2.webp",
        precio: 28000,
        categoria: {
            nombre: "Batas",
            id: "bata"/*este el id de la categoria*/
        },


    },
    {
        id: "bata03",/*este el id del prod */
        titulo: "Bata beige",
        imagen: "../img/productos/batas/bata3.webp",
        precio: 28000,
        categoria: {
            nombre: "Batas",
            id: "bata"/*este el id de la categoria*/
        },

    },
    {
        id: "bata04",/*este el id del prod */
        titulo: "Bata clara beige",
        imagen: "../img/productos/batas/bata5.webp",
        precio: 20000,
        categoria: {
            nombre: "Batas",
            id: "bata"/*este el id de la categoria*/
        },

    },

    //      CORTINAS 39 A 47

    {
        id: "cortina01",/*este el id del prod */
        titulo: "Cortina gris topo",
        imagen: "../img/productos/cortinas/cortina1.webp",
        precio: 30000,
        categoria: {
            nombre: "Cortinas",
            id: "corti"/*este el id de la categoria*/
        },

    },
    {
        id: "cortina02",/*este el id del prod */
        titulo: "Cortina clara con lineas",
        imagen: "../img/productos/cortinas/cortina2.webp",
        precio: 30000,
        categoria: {
            nombre: "Cortinas",
            id: "corti"/*este el id de la categoria*/
        },

    },
    {
        id: "cortina03",/*este el id del prod */
        titulo: "Cortina elegante bordo",
        imagen: "../img/productos/cortinas/cortina3.webp",
        precio: 33000,
        categoria: {
            nombre: "Cortinas",
            id: "corti"/*este el id de la categoria*/
        },

    },
    {
        id: "cortina04",/*este el id del prod */
        titulo: "Cortina elegante gris oscuro",
        imagen: "../img/productos/cortinas/cortina4.webp",
        precio: 33000,
        categoria: {
            nombre: "Cortinas",
            id: "corti"/*este el id de la categoria*/
        },

    },
    {
        id: "cortina05",/*este el id del prod */
        titulo: "Cortina lienzo",
        imagen: "../img/productos/cortinas/cortina5.webp",
        precio: 27000,
        categoria: {
            nombre: "Cortinas",
            id: "corti"/*este el id de la categoria*/
        },

    },
    {
        id: "cortina06",/*este el id del prod */
        titulo: "Cortina baño blanca",
        imagen: "../img/productos/cortinas/cortinabaño2.webp",
        precio: 24000,
        categoria: {
            nombre: "Cortinas",
            id: "corti"/*este el id de la categoria*/
        },

    },
    {
        id: "cortina07",/*este el id del prod */
        titulo: "Cortina Baño Estampa",
        imagen: "../img/productos/cortinas/cortinabaño3.webp",
        precio: 20000,
        categoria: {
            nombre: "Cortinas",
            id: "corti"/*este el id de la categoria*/
        },

    },
    {
        id: "cortina08",/*este el id del prod */
        titulo: "Cortina Baño Estampa",
        imagen: "../img/productos/cortinas/cortinabaño4.webp",
        precio: 20000,
        categoria: {
            nombre: "Cortinas",
            id: "corti"/*este el id de la categoria*/
        },

    },
    {
        id: "cortina09",/*este el id del prod */
        titulo: "Cortina Baño beige",
        imagen: "../img/productos/cortinas/cortinabaño1.webp",
        precio: 20000,
        categoria: {
            nombre: "Cortinas",
            id: "corti"/*este el id de la categoria*/
        },

    },

    // ALMOHADONES 48 A 52

    {
        id: "almohadon01",/*este el id del prod */
        titulo: "Almohadon gris con borlas",
        imagen: "../img/productos/almohadones/almohadon1.webp",
        precio: 13000,
        categoria: {
            nombre: "Almohadones",
            id: "almohadon"/*este el id de la categoria*/
        },

    },
    {
        id: "almohadon02",/*este el id del prod */
        titulo: "Almohadon lienzo con diseño",
        imagen: "../img/productos/almohadones/almohadon2.webp",
        precio: 12000,
        categoria: {
            nombre: "Almohadones",
            id: "almohadon"/*este el id de la categoria*/
        },

    },
    {
        id: "almohadon03",/*este el id del prod */
        titulo: "Almohadon turquesa con borlas",
        imagen: "../img/productos/almohadones/almohadon3.webp",
        precio: 12000,
        categoria: {
            nombre: "Almohadones",
            id: "almohadon"/*este el id de la categoria*/
        },

    },
    {
        id: "almohadon04",/*este el id del prod */
        titulo: "Almohadon con diseño",
        imagen: "../img/productos/almohadones/almohadon4.webp",
        precio: 12000,
        categoria: {
            nombre: "Almohadones",
            id: "almohadon"/*este el id de la categoria*/
        },

    },
    {
        id: "almohadon05",/*este el id del prod */
        titulo: "Almohadon peludo",
        imagen: "../img/productos/almohadones/almohadon5.webp",
        precio: 14000,
        categoria: {
            nombre: "Almohadones",
            id: "almohadon"/*este el id de la categoria*/
        },

    },


];


//Seleccionamos los elementos dom que vamos a usar

var contenedorProductos = document.getElementById("cont-productos");
var botonesFiltro = document.querySelectorAll(".botones-filtro");
var tituloPrincipal = document.querySelector("#tituloPrincipal");
var botonesAgregar = document.querySelectorAll(".boton-agregar-producto");


console.log(contenedorProductos); // lo hizo lucas para ver que tiene
console.log(typeof contenedorProductos) // lo hizo lucas para ver que tiene
function cargarProductos(productoFiltrado) {
    contenedorProductos.innerHTML = ""; //limpiamos para que no se agreguen prod cada vez que clickeamos un boton de filtro
    productoFiltrado.forEach(producto => { //recorremos el array y por cada elemento se cra un div y luego el contenido del mismo

        var div = document.createElement("div");

        div.classList.add("producto");
        //${producto.imagen} plantilla de cadena literal de js, la usamos para insertar dinámicamente valores dentro de la cadena.
        div.innerHTML = `
            <img class="imagen-producto" src="${producto.imagen}" alt="${producto.titulo}">
            <div class="descripcion-producto">
                <h3 class="producto-titulo">${producto.titulo}</h3> 
                <p class="producto-precio">$${producto.precio}</p>
                <button class="boton-agregar-producto" id="${producto.id}">AGREGAR AL CARRITO</button>
            </div>
        `;
        contenedorProductos.append(div);

    });
    actualizarBotonesAgregar();
    console.log(agregarAlCarrito)
}


cargarProductos(productosArray);


botonesFiltro.forEach(boton => {
    boton.addEventListener("click", (evento) => {

        botonesFiltro.forEach(boton => boton.classList.remove("activo"));//le sacamos acttivoa todos los para desactivarlos visualmente.
        evento.currentTarget.classList.add("activo");//se lo agrego al boton que se le hizo click, asi toma los atributo del css
        //con classList manipulamos la clase del elemento(quitamos y agregamos la clase activo )
        if (evento.currentTarget.id != "todos-los-productos") {//si el boton clickeado no es el de todo los prod que filtre por categoria

            var tituloCategoria = productosArray.find(producto => producto.categoria.id === evento.currentTarget.id)
            tituloPrincipal.innerText = tituloCategoria.categoria.nombre;

            //con el filter seteamos el array y creamos uno nuevo con los elementos que coincidan con su id (id de categoria del producto con el id del boton filtro(lista de categorias))
            var botonElegido = productosArray.filter(producto => producto.categoria.id === evento.currentTarget.id);
            cargarProductos(botonElegido);//nuevo array




        }
        else {  // Si el botón clicado es "todos-los-productos", carga todo el array.
            tituloPrincipal.innerText = "Todos los Productos"
            cargarProductos(productosArray);
        }

    })



})



function actualizarBotonesAgregar() {// cada vez que se carguen productos nuevos(por el filtro) vuelva a buscar en el html todos los bot agregar que existan para esa categoria
    botonesAgregar = document.querySelectorAll(".boton-agregar-producto");//esta funcion se llama cada vez que cargamos los prod//asegura que los botones Agregar al carrito estén actualizados y listos para su interacción después de cargar nuevos productos

    botonesAgregar.forEach(boton => {//
        boton.addEventListener("click", agregarAlCarrito)//este listener va a llamar a la funcion
    })
}


var productosEncarrito = [];

function agregarAlCarrito(evento) {//el currentTarget es una prop para referirse al objeto al cual el evento está actualmente manejando
    var idBoton = evento.currentTarget.id

    var prodAgregado = productosArray.find(producto => producto.id === idBoton)//creamoa un producto agregado

    if (productosEncarrito.some(producto => producto.id === idBoton)) {
        var indiceProdAgregado = productosEncarrito.findIndex(producto => producto.id === idBoton);
        productosEncarrito[indiceProdAgregado].cantidad++;


    }
    else {
        prodAgregado.cantidad = 1; // estariamos agregando la prop cantidad al array, y si entra al array es porque hay un prod del mismo tipo agregado
        productosEncarrito.push(prodAgregado);

    }

    actualizarNumCarrito();
    //console.log(productosEncarrito)
   
}

function actualizarNumCarrito() {
    var numCarrito = document.querySelector(".num-carrito");
    var nuevoNumero = productosEncarrito.reduce((acc, producto) => acc + producto.cantidad, 0);
    numCarrito.innerText = nuevoNumero;
   

}





////////////////

const categoriasSet = new Set();
// Recorremos el array de productos y agregamos cada nombre de categoría al conjunto
productosArray.forEach(producto => {
    categoriasSet.add(producto.categoria.nombre);
});
// Convertimos el conjunto en un array
const productosArraySinRepetir = Array.from(categoriasSet);
// console.log(categoriasArray);





//obtenemos el dato que estamos buscando

document.addEventListener('DOMContentLoaded', () => {


        mostrarItem(productosArraySinRepetir);
        buscarItem()
        limpiarhtml()


        if(document.getElementById('lupa')==""){ // no puedo limpiar la busqueda
            limpiarhtml()
        }
    

});
function mostrarItem(productosArraySinRepetir) {
    var resultado = document.getElementById('resultado');
    productosArraySinRepetir.forEach(item => {
        const elemento = document.createElement("p");
        elemento.innerHTML = `${item}`;
        elemento.id="idsearch"
        resultado.appendChild(elemento);
    });

}

function buscarItem() {
    var search = document.getElementById("lupa");
    search.addEventListener("input", e => {
        limpiarhtml()
        const inputText = e.target.value.toUpperCase().trim();
        if(inputText.length > 0){
            var botonElegido = productosArray.filter(producto => producto.categoria.nombre.toLocaleUpperCase().startsWith(inputText));
            cargarProductos(botonElegido);//nuevo array

        const mostrarFiltrado = productosArraySinRepetir.filter(item =>  item.toLocaleUpperCase().startsWith(inputText));
        if (mostrarFiltrado.length) {
            mostrarItem(mostrarFiltrado)
        } else {
            noResultado();
        }
    }
    });
}



function limpiarhtml() {
    var resultado = document.getElementById('resultado');
    while (resultado.lastChild) {
        resultado.removeChild(resultado.lastChild);
    }
}


function noResultado() {
    var resultado = document.getElementById('resultado');
    const noResultado = document.createElement('resultado')
    noResultado.textContent = "No hay resultados";
    resultado.appendChild(noResultado);

}

const input = document.getElementById('lupa'); // no se limpia cuando retiro el cursor de la buqueda
// input.addEventListener('blur', limpiarhtml())
    


var idsearch = document.getElementById('idsearch');
var lupaicono = document.getElementsByClassName('lupa-icono');
var search = document.getElementById("lupa");
console.log('entro');
// lupaicono.addEventListener('click', () => {
//     alert('entro');
// });


